@using Microsoft.AspNetCore.Routing
@using Nop.Plugin.Baramjk.PhotoPlatform.Areas.Admin.Models.ActorEvents
@using Nop.Web.Framework.Models.DataTables
@{
}

<div class="card-body">
    <div class="cards-group">
        <div class="card card-default">
            <div class="card-header">
                <h5 class="float-left">
                    @T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.Widget.ActorEvent.Title")
                </h5>
                <div class="card-tools float-right">
                    <button type="submit" id="btnAddNewActor"
                            onclick="OpenWindow('@(Url.Action("ActorAddPopup", "ActorEvent", new { Model.EventId, RefreshBtnId = "btnRefreshActors" }))', 800, 800, true); return false;"
                            class="btn btn-primary">
                        <i class="fas fa-plus-square"></i>
                        @T("Admin.Common.AddNew")
                    </button>

                    <button type="submit" id="btnEditAllActorShares"
                            onclick="OpenWindow('@(Url.Action("BulkActorShareEditPopUp", "ActorEvent", new { Model.EventId, RefreshBtnId = "btnRefreshActors" }))', 800, 800, true); return false;"
                            class="btn btn-primary">
                        <i class="fas fa-pencil-alt"></i>
                        @T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.EditAllActorShares")
                    </button>

                    <button type="submit" id="btnEditAllProductionShares"
                            onclick="OpenWindow('@(Url.Action("BulkProductionShareEditPopUp", "ActorEvent", new { Model.EventId, RefreshBtnId = "btnRefreshActors" }))', 800, 800, true); return false;"
                            class="btn btn-primary">
                        <i class="fas fa-pencil-alt"></i>
                        @T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.EditAllProductionShares")
                    </button>
                    
                    <button type="submit" id="btnRefreshActors" style="display: none"></button>
                    <script>
                        $(document).ready(function () {
                            $('#btnRefreshActors').click(function () {
                                //refresh grid
                                updateTable('#actor-events-grid');
                                //return false to don't reload a page
                                return false;
                            });
                        });
                    </script>
                </div>
            </div>
            <div class="card-body">

                @await Html.PartialAsync("Table", new DataTablesModel
                {
                    Name = "actor-events-grid",
                    UrlRead = new DataUrl("List", "ActorEvent", new RouteValueDictionary
                    {
                        [nameof(Model.EventId)] = Model.EventId
                    }),
                    UrlDelete = new DataUrl("DeleteById", "ActorEvent", null),
                    UrlUpdate = new DataUrl("Edit", "ActorEvent", null),
                    Length = Model.PageSize,
                    LengthMenu = Model.AvailablePageSizes,
                    ColumnCollection = new List<ColumnProperty>
                    {
                        new(nameof(ActorEventsItemModel.ActorName))
                        {
                            Width = "200",
                            Title = T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.ActorEvents.ActorName").Text,
                            ClassName = NopColumnClassDefaults.CenterAll
                        },

                        new(nameof(ActorEventsItemModel.ActorPictureUrl))
                        {
                            Title = T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.ActorEvents.ActorPictureUrl").Text,
                            Width = "200",
                            ClassName = NopColumnClassDefaults.CenterAll,
                            Render = new RenderPicture()
                        },

                        new(nameof(ActorEventsItemModel.ActorPhotoPrice))
                        {
                            Width = "100",
                            Title = T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.ActorEvents.ActorPhotoPrice").Text,
                            ClassName = NopColumnClassDefaults.CenterAll,
                            Editable = true,
                            EditType = EditType.Number,
                        },

                        new(nameof(ActorEventsItemModel.ActorShare))
                        {
                            Width = "100",
                            Title = T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.ActorEvents.ActorShare").Text,
                            ClassName = NopColumnClassDefaults.CenterAll,
                            Editable = true,
                            EditType = EditType.Number,
                        },

                        new(nameof(ActorEventsItemModel.ProductionShare))
                        {
                            Width = "100",
                            Title = T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.ActorEvents.ProductionShare").Text,
                            ClassName = NopColumnClassDefaults.CenterAll,
                        },

                        new(nameof(ActorEventsItemModel.DisplayOrder))
                        {
                            Width = "100",
                            Title = T("Nop.Plugin.Baramjk.PhotoPlatform.Admin.ActorEvents.DisplayOrder").Text,
                            ClassName = NopColumnClassDefaults.CenterAll,
                            Editable = true,
                            EditType = EditType.Number,
                        },

                        new(nameof(ActorEventsItemModel.Id))
                        {
                            Title = T("Admin.Common.Edit").Text,
                            Width = "80",
                            ClassName = NopColumnClassDefaults.Button,
                            Render = new RenderButtonsInlineEdit()
                        },

                        new(nameof(ActorEventsItemModel.Id))
                        {
                            Title = T("Admin.Common.Delete").Text,
                            Width = "80",
                            ClassName = NopColumnClassDefaults.Button,
                            Render = new RenderButtonRemove(T("Admin.Common.Delete").Text)
                        }
                    }
                })

            </div>
        </div>
        <script>
            $(document).ready(function () {
                $('#btnRefreshActors').click(function () {
                    updateTable('#actor-events-grid');
                    return false;
                });
            });
        </script>
    </div>
</div>